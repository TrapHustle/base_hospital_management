<?xml version="1.0" encoding="UTF-8"?>
<templates>
    <t t-name="ReceptionDashboard">
        <div class="r_Container" t-ref="root">
            
            <!-- ====================================
                 MAIN NAVIGATION
                 ==================================== -->
            <div class="r_dashButtonContainer">
                <button class="r_dashButton r_active o_patient_button" t-on-click="createPatient">
                    <svg class="patient_img" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    <span>Patient</span>
                </button>
                
                <button class="r_dashButton o_appointment_button" t-on-click="fetchAppointmentData">
                    <svg class="apnmnt_img" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    <span>Rendez-vous</span>
                </button>
                
                <button class="r_dashButton o_room_ward_button" t-on-click="fetchRoomWard">
                    <svg class="room_ward_img" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                    <span>Chambres/Services</span>
                </button>
            </div>

            <!-- ====================================
                 MAIN CONTENT AREA
                 ==================================== -->
            <div id="view_main">
                
                <!-- PATIENT CREATION SECTION -->
                <div class="r_View" t-ref="patient_creation">
                    <div class="form-section">
                        <div class="form-section-header">
                            <h2 class="form-section-title">Enregistrement Nouveau Patient</h2>
                            <p class="form-section-subtitle">Remplissez les informations du patient</p>
                        </div>
                        
                        <div class="r_Profile">
                            <div class="hsp_table">
                                <table>
                                    <tbody>
                                        <tr>
                                            <td>
                                                <div class="form-group form-group-required">
                                                    <label for="patient-name">Nom complet</label>
                                                    <input type="text" id="patient-name" placeholder="Nom et prénom"/>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <label for="patient-bloodgroup">Groupe sanguin</label>
                                                    <select id="patient-bloodgroup">
                                                        <option value="">Sélectionner</option>
                                                        <option value="A">A</option>
                                                        <option value="B">B</option>
                                                        <option value="AB">AB</option>
                                                        <option value="O">O</option>
                                                    </select>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="form-group form-group-required">
                                                    <label for="patient-phone">Téléphone</label>
                                                    <input type="tel" id="patient-phone" placeholder="+212 6XX XXX XXX"/>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <label for="patient-mail">Email</label>
                                                    <input type="email" id="patient-mail" placeholder="email@example.com"/>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="form-group">
                                                    <label for="patient-dob">Date de naissance</label>
                                                    <input type="date" id="patient-dob"/>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <label for="patient-m-status">État civil</label>
                                                    <select id="patient-m-status">
                                                        <option value="">Sélectionner</option>
                                                        <option value="married">Marié(e)</option>
                                                        <option value="unmarried">Célibataire</option>
                                                        <option value="widow">Veuf/Veuve</option>
                                                        <option value="divorcee">Divorcé(e)</option>
                                                    </select>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="form-group">
                                                    <label>Rhésus (RH)</label>
                                                    <div style="display: flex; gap: 20px; margin-top: 8px;">
                                                        <label class="radio">
                                                            <input type="radio" name="rhtype" value="+" id="rh-positive"/>
                                                            <span>Positif (+)</span>
                                                        </label>
                                                        <label class="radio">
                                                            <input type="radio" name="rhtype" value="-" id="rh-negative"/>
                                                            <span>Négatif (-)</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <label>Genre</label>
                                                    <div style="display: flex; gap: 20px; margin-top: 8px;">
                                                        <label class="radio">
                                                            <input type="radio" name="gender" value="male" id="gender-male"/>
                                                            <span>Homme</span>
                                                        </label>
                                                        <label class="radio">
                                                            <input type="radio" name="gender" value="female" id="gender-female"/>
                                                            <span>Femme</span>
                                                        </label>
                                                        <label class="radio">
                                                            <input type="radio" name="gender" value="other" id="gender-other"/>
                                                            <span>Autre</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <div class="form-group">
                                                    <label for="patient-img">Photo du patient</label>
                                                    <input type="file" id="patient-img" accept="image/*" data-file=""/>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div class="save">
                                    <button class="save_patient" t-on-click="savePatient">Enregistrer</button>
                                    <button class="saveandnew_patient" t-on-click="savePatient">Enregistrer et nouveau</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- APPOINTMENTS SECTION -->
                <div class="r_View d-none" t-ref="appointments_section">
                    
                    <!-- Secondary Navigation -->
                    <div class="rd_buttons">
                        <div class="row r_AppntBtn">
                            <div class="col-md-6 col-sm-6" style="padding-right: 10px;">
                                <div class="r_AppointmentBtn r_active1" t-on-click="createOutPatient">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <polyline points="12 6 12 12 16 14"></polyline>
                                    </svg>
                                    Consultation (Externe)
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6" style="padding-left: 10px;">
                                <div class="r_AppointmentBtn" t-on-click="createInPatient">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;">
                                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                    </svg>
                                    Hospitalisation (Interne)
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Outpatient Form - Shown when state.current_appointment_type == 'outpatient' -->
                    <div class="form-section" t-if="state.current_appointment_type == 'outpatient'">
                        <div class="form-section-header">
                            <h2 class="form-section-title">Nouveau Rendez-vous</h2>
                            <p class="form-section-subtitle">Consultation externe</p>
                        </div>
                        
                        <div id="op_table" style="max-width: 800px; margin: 0 auto;">
                            <table style="width: 100%;">
                                <tbody>
                                    <tr>
                                        <td colspan="2">
                                            <div class="form-group">
                                                <label for="select_type">Type de patient</label>
                                                <select id="select_type" t-on-change="patient_card">
                                                    <option value="have_card">Patient existant</option>
                                                    <option value="dont_have_card">Nouveau patient</option>
                                                </select>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            <div class="form-group">
                                                <label for="sl_patient" id="patient_label">Sélectionner patient</label>
                                                <select id="sl_patient" class="select_patient" t-on-change="fetch_patient_id">
                                                    <option value="">-- Choisir un patient --</option>
                                                    <t t-foreach="state.patient_lst" t-as="patient" t-key="patient.id">
                                                        <option t-att-value="patient.id">
                                                            <t t-esc="patient.patient_seq"/> - <t t-esc="patient.name"/>
                                                        </option>
                                                    </t>
                                                </select>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="form-group form-group-required">
                                                <label for="o_patient-name">Nom du patient</label>
                                                <input type="text" id="o_patient-name" placeholder="Nom complet"/>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="form-group form-group-required">
                                                <label for="o_patient-phone">Téléphone</label>
                                                <input type="tel" id="o_patient-phone" placeholder="+212 6XX XXX XXX"/>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="form-group">
                                                <label for="o_patient-dob">Date de naissance</label>
                                                <input type="date" id="o_patient-dob"/>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="form-group">
                                                <label for="o_patient_bloodgroup">Groupe sanguin</label>
                                                <select id="o_patient_bloodgroup">
                                                    <option value="">Sélectionner</option>
                                                    <option value="A">A</option>
                                                    <option value="B">B</option>
                                                    <option value="AB">AB</option>
                                                    <option value="O">O</option>
                                                </select>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="form-group">
                                                <label>Rhésus (RH)</label>
                                                <div style="display: flex; gap: 20px; margin-top: 8px;">
                                                    <label class="radio">
                                                        <input type="radio" name="o_rhtype" value="+" id="o_rhtype"/>
                                                        <span>Positif (+)</span>
                                                    </label>
                                                    <label class="radio">
                                                        <input type="radio" name="o_rhtype" value="-"/>
                                                        <span>Négatif (-)</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="form-group">
                                                <label>Genre</label>
                                                <div style="display: flex; gap: 20px; margin-top: 8px;">
                                                    <label class="radio">
                                                        <input type="radio" name="o_patient-gender" value="male" id="o_patient-gender"/>
                                                        <span>Homme</span>
                                                    </label>
                                                    <label class="radio">
                                                        <input type="radio" name="o_patient-gender" value="female"/>
                                                        <span>Femme</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="form-group form-group-required">
                                                <label for="op_date">Date du rendez-vous</label>
                                                <input type="date" id="op_date" t-att-value="state.currentDate"/>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="form-group form-group-required">
                                                <label for="sl_dr">Médecin</label>
                                                <select id="sl_dr" class="select_dr">
                                                    <t t-foreach="state.dr_lst" t-as="doctor" t-key="doctor.id">
                                                        <option t-att-value="doctor.id">
                                                            <t t-esc="doctor.display_name"/>
                                                        </option>
                                                    </t>
                                                </select>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="form-group">
                                                <label for="slot">Heure</label>
                                                <input type="text" id="slot" placeholder="Ex: 09:00" readonly="readonly"/>
                                            </div>
                                        </td>
                                        <td>
                                            <div id="controls"></div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            <div class="form-group">
                                                <label for="reason">Motif de consultation</label>
                                                <textarea id="reason" rows="3" placeholder="Décrivez le motif de la visite..."></textarea>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <div class="save">
                                <button class="save_out_patient" t-on-click="save_out_patient_data">Créer rendez-vous</button>
                                <button class="saveandnew_out_patient">Créer et nouveau</button>
                            </div>
                        </div>
                    </div>

                    <!-- Inpatient Form - Shown when state.current_appointment_type == 'inpatient' -->
                    <div class="form-section" t-if="state.current_appointment_type == 'inpatient'">
                        <div class="form-section-header">
                            <h2 class="form-section-title">Nouvelle Hospitalisation</h2>
                            <p class="form-section-subtitle">Admission d'un patient</p>
                        </div>
                        
                        <div class="hsp_table">
                            <table style="width: 100%;">
                                <tbody>
                                    <tr>
                                        <td>
                                            <div class="form-group form-group-required">
                                                <label for="sl_patient_id">Patient</label>
                                                <select id="sl_patient_id" class="select_patient_id">
                                                    <option value="">-- Sélectionner patient --</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="form-group form-group-required">
                                                <label for="attending_doctor_id">Médecin traitant</label>
                                                <select id="attending_doctor_id" class="attending_doctor_id">
                                                    <option value="">-- Sélectionner médecin --</option>
                                                </select>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="form-group form-group-required">
                                                <label for="admission_type">Type d'admission</label>
                                                <select id="admission_type">
                                                    <option value="">-- Sélectionner --</option>
                                                    <option value="emergency">Urgence</option>
                                                    <option value="planned">Programmée</option>
                                                    <option value="transfer">Transfert</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="form-group">
                                                <label for="hosp_date">Date d'admission</label>
                                                <input type="date" id="hosp_date" t-att-value="state.currentDate"/>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            <div class="form-group">
                                                <label for="reason_of_admission">Motif d'admission</label>
                                                <textarea id="reason_of_admission" rows="4" placeholder="Décrivez le motif de l'hospitalisation..."></textarea>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <div class="save">
                                <button class="save_patient" t-on-click="save_in_patient_data">Créer admission</button>
                                <button class="saveandnew_patient">Créer et nouveau</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ROOM/WARD SECTION -->
                <div class="r_View d-none" t-ref="room_ward">
                    
                    <!-- Secondary Navigation -->
                    <div class="row r_AppntBtn">
                        <div class="col-md-6 col-sm-6" style="padding-right: 10px;">
                            <div class="r_RoomWard r_active2" t-on-click="fetchWard">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                    <line x1="9" y1="3" x2="9" y2="21"></line>
                                </svg>
                                Services
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6" style="padding-left: 10px;">
                            <div class="r_RoomWard" t-on-click="fetchRoom">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;">
                                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                </svg>
                                Chambres
                            </div>
                        </div>
                    </div>

                    <!-- Ward List - Shown when state.current_room_ward_type == 'ward' -->
                    <div class="data-table-container" t-if="state.current_room_ward_type == 'ward'">
                        <div class="data-table-header">
                            <h3 class="data-table-title">Liste des Services</h3>
                            <div class="search-container">
                                <input type="text" id="ward_search" placeholder="Rechercher un service..." style="min-height: 38px; padding: 8px 12px;"/>
                            </div>
                        </div>
                        
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Numéro</th>
                                    <th>Bâtiment</th>
                                    <th>Étage</th>
                                    <th>Nombre de lits</th>
                                    <th>Statut</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="state.ward_data" t-as="ward" t-key="ward.id">
                                    <tr>
                                        <td><t t-esc="ward.ward_no"/></td>
                                        <td><t t-esc="ward.building_id and ward.building_id[1]"/></td>
                                        <td><t t-esc="ward.floor_no"/></td>
                                        <td><t t-esc="ward.bed_count"/></td>
                                        <td>
                                            <span class="badge badge-success">Actif</span>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>

                    <!-- Room List - Shown when state.current_room_ward_type == 'room' -->
                    <div class="data-table-container" t-if="state.current_room_ward_type == 'room'">
                        <div class="data-table-header">
                            <h3 class="data-table-title">Liste des Chambres</h3>
                            <div class="search-container">
                                <input type="text" id="room_search" placeholder="Rechercher une chambre..." style="min-height: 38px; padding: 8px 12px;"/>
                            </div>
                        </div>
                        
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Chambre</th>
                                    <th>Bâtiment</th>
                                    <th>Étage</th>
                                    <th>Type de lit</th>
                                    <th>Prix/jour</th>
                                    <th>Statut</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="state.room_data" t-as="room" t-key="room.id">
                                    <tr>
                                        <td><strong><t t-esc="room.name"/></strong></td>
                                        <td><t t-esc="room.building_id and room.building_id[1]"/></td>
                                        <td><t t-esc="room.floor_no"/></td>
                                        <td><t t-esc="room.bed_type"/></td>
                                        <td><t t-esc="room.rent"/> MAD</td>
                                        <td>
                                            <t t-if="room.state == 'avail'">
                                                <span class="badge badge-success">Disponible</span>
                                            </t>
                                            <t t-elif="room.state == 'reserve'">
                                                <span class="badge badge-warning">Réservée</span>
                                            </t>
                                            <t t-else="">
                                                <span class="badge badge-danger">Occupée</span>
                                            </t>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </t>
</templates>